<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TripSmart | AI-Powered Group Travel</title>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">

<style>
body { font-family: 'Plus Jakarta Sans', sans-serif; scroll-behavior:smooth; }
.glass {
  background: rgba(255,255,255,0.75);
  backdrop-filter: blur(14px);
  border: 1px solid rgba(255,255,255,0.4);
}
.step { display:none }
.step.active { display:block; animation:fadeUp .4s ease-out }
@keyframes fadeUp {
  from{opacity:0;transform:translateY(15px)}
  to{opacity:1;transform:translateY(0)}
}
</style>
</head>

<body class="bg-slate-50 text-slate-900">

<!-- ================= LANDING ================= -->
<header class="relative h-[85vh] flex items-center justify-center overflow-hidden">
  <div class="absolute inset-0">
    <img src="{{ url_for('static', filename='images/hero.jpg') }}"
         class="w-full h-full object-cover scale-105 animate-[pulse_8s_infinite]">
    <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-black/30 to-slate-50"></div>
  </div>

  <div class="relative z-10 text-center px-6 max-w-4xl">
    <h1 class="text-5xl md:text-7xl font-extrabold text-white mb-6">
      Trips your whole group <br>
      <span class="text-teal-400">actually agrees on</span>
    </h1>
    <p class="text-xl text-slate-200 mb-10">
      AI-powered group travel planning with explainable decisions.
    </p>
    <a href="#planner"
       class="bg-teal-600 text-white px-10 py-4 rounded-2xl font-bold shadow-xl hover:-translate-y-1 transition">
       Start Planning
    </a>
  </div>
</header>

<!-- ================= PLANNER ================= -->
<section id="planner" class="py-20 -mt-32 relative z-20 px-6">
<div class="max-w-2xl mx-auto glass p-10 rounded-[2.5rem] shadow-xl">

<div class="flex gap-2 mb-10">
  <div id="dot1" class="h-1.5 flex-1 bg-teal-600 rounded-full"></div>
  <div id="dot2" class="h-1.5 flex-1 bg-slate-200 rounded-full"></div>
  <div id="dot3" class="h-1.5 flex-1 bg-slate-200 rounded-full"></div>
</div>

<form method="POST" action="/#results">

<!-- STEP 1 -->
<div id="step1" class="step active space-y-6">
  <h2 class="text-3xl font-bold">Trip basics</h2>

  <select name="region" class="w-full p-4 rounded-2xl border">
    <option value="">Anywhere in India</option>
    <option>North</option><option>South</option>
    <option>West</option><option>North-East</option>
  </select>

  <div class="grid grid-cols-2 gap-4">
    <input name="people" type="number" placeholder="Group size" class="p-4 rounded-2xl border" required>
    <input name="days" type="number" placeholder="Days" class="p-4 rounded-2xl border" required>
  </div>

  <button type="button" onclick="goToStep(2)"
          class="w-full bg-slate-900 text-white py-4 rounded-2xl font-bold">
    Continue â†’
  </button>
</div>

<!-- STEP 2 -->
<div id="step2" class="step space-y-6">
  <h2 class="text-3xl font-bold">Whatâ€™s the vibe?</h2>

  <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
    {% for icon,label in [
      ("ğŸŒŠ","Beach"),("ğŸ”","Adventure"),("ğŸŒ¿","Nature"),
      ("ğŸ›","Cultural"),("ğŸ§˜","Relaxation")
    ] %}
    <label class="cursor-pointer">
      <input type="checkbox" name="interests" value="{{ label }}" class="hidden peer">
      <div class="p-6 rounded-3xl border peer-checked:border-teal-600 peer-checked:bg-teal-50 text-center">
        <div class="text-3xl">{{ icon }}</div>
        <b>{{ label }}</b>
      </div>
    </label>
    {% endfor %}
  </div>

  <button type="button" onclick="goToStep(3)"
          class="w-full bg-slate-900 text-white py-4 rounded-2xl font-bold">
    Almost done â†’
  </button>
</div>

<!-- STEP 3 -->
<div id="step3" class="step space-y-6">
  <h2 class="text-3xl font-bold">Final details</h2>

  <input type="range" min="1000" max="10000" step="500"
         name="budget" value="3000"
         oninput="budgetVal.innerText=this.value"
         class="w-full accent-teal-600">

  <div class="text-3xl font-black text-teal-600">
    â‚¹<span id="budgetVal">3000</span>/day
  </div>

  <input name="visited_votes" placeholder="Visited votes (Goa:2)"
         class="w-full p-4 rounded-2xl border">

  <button class="w-full bg-teal-600 text-white py-5 rounded-2xl font-black text-xl">
    GENERATE MY TRIP âœ¨
  </button>
</div>

</form>
</div>
</section>

<!-- ================= RESULTS ================= -->
{% if results %}
{% set interests = request.form.getlist('interests') %}
{% if 'Beach' in interests %}
  {% set hero_img='beach.jpg' %}
{% elif 'Nature' in interests %}
  {% set hero_img='nature.jpg' %}
{% elif 'Adventure' in interests %}
  {% set hero_img='adventure.jpg' %}
{% elif 'Cultural' in interests %}
  {% set hero_img='cultural.jpg' %}
{% elif 'Relaxation' in interests %}
  {% set hero_img='relaxation.jpg' %}
{% else %}
  {% set hero_img='hero.jpg' %}
{% endif %}

<section id="results" class="max-w-7xl mx-auto px-6 py-20">

<!-- HERO -->
<div class="relative h-[450px] rounded-[3rem] overflow-hidden shadow-2xl mb-16">
  <img src="{{ url_for('static', filename='images/' ~ hero_img) }}"
       class="absolute inset-0 w-full h-full object-cover">
  <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>

  <div class="absolute bottom-12 left-12 text-white">
    <h2 class="text-6xl font-black">{{ results[0].destination }}</h2>
    <p class="text-lg opacity-90">Best match for your group</p>
  </div>
</div>

<div class="grid lg:grid-cols-12 gap-12">

<!-- LEFT -->
<div class="lg:col-span-7 space-y-14">

<!-- WHY -->
<div class="bg-white p-10 rounded-[2.5rem] shadow-sm border">
  <h3 class="text-2xl font-bold mb-8">Why these destinations?</h3>
  {% for r in results %}
  <div class="mb-6">
    <div class="flex justify-between font-bold mb-2">
      <span>{{ r.destination }}</span>
      <span class="text-teal-600">{{ r.final_score_pct }}%</span>
    </div>
    <div class="h-3 bg-slate-200 rounded-full">
      <div class="h-3 bg-teal-600 rounded-full" style="width:{{ r.final_score_pct }}%"></div>
    </div>
  </div>
  {% endfor %}
</div>

<!-- ITINERARY -->
<div>
  <h3 class="text-3xl font-bold mb-6">The Game Plan</h3>
  <div class="space-y-6">
    {% for day in itinerary %}
    <div class="glass p-8 rounded-[2rem] cursor-pointer hover:shadow-xl transition"
         onclick="this.querySelector('.details').classList.toggle('hidden')">
      <div class="flex justify-between items-center">
        <h4 class="text-xl font-bold">{{ day.split(':')[0] }}</h4>
        <span class="text-slate-400">â–¼</span>
      </div>
      <p class="details hidden mt-4 text-slate-600">
        {{ day.split(':',1)[1] if ':' in day else "Explore local attractions and enjoy your day." }}
      </p>
    </div>
    {% endfor %}
  </div>
</div>

</div>

<!-- RIGHT -->
<div class="lg:col-span-5 sticky top-10 space-y-6">

<div id="map" class="h-[550px] rounded-[3rem] border-8 border-white shadow-xl"></div>

<!-- WEATHER -->
{% if weather %}
<div class="glass p-8 rounded-[2.5rem]">
  <h4 class="font-bold mb-2">ğŸŒ¦ Weather Forecast</h4>
  <p class="text-slate-600 text-sm">
    Temperature: <b>{{ weather.temperature }}Â°C</b><br>
    Wind Speed: <b>{{ weather.windspeed }} km/h</b>
  </p>
</div>
{% endif %}

<!-- BOOKINGS -->
<div class="glass p-8 rounded-[2.5rem] space-y-4">
  <h4 class="font-bold">ğŸ”— Book Your Trip</h4>
  <a target="_blank"
     href="https://www.google.com/travel/flights?q={{ results[0].destination }}"
     class="block bg-teal-600 text-white py-3 rounded-xl text-center font-bold">
     âœˆï¸ Flights
  </a>
  <a target="_blank"
     href="https://www.booking.com/searchresults.html?ss={{ results[0].destination }}"
     class="block bg-slate-900 text-white py-3 rounded-xl text-center font-bold">
     ğŸ¨ Hotels
  </a>
  <a target="_blank"
     href="https://www.google.com/search?q=things+to+do+in+{{ results[0].destination }}"
     class="block bg-slate-700 text-white py-3 rounded-xl text-center font-bold">
     ğŸŸ Experiences
  </a>
</div>

<!-- INSIGHT -->
<div class="glass p-8 rounded-[2.5rem]">
  <h4 class="font-bold mb-2">Travelerâ€™s Insight</h4>
  <p class="text-slate-600 text-sm">
    We recommended <b>{{ results[0].destination }}</b> because it best matches
    <b>{{ interests | join(', ') }}</b>, fits your â‚¹{{ request.form.get('budget') }}/day budget,
    and avoids destinations already visited by most group members.
  </p>
</div>

</div>
</div>
</section>
{% endif %}

<footer class="py-10 text-center text-slate-400 text-sm">
  Â© 2026 TripSmart AI
</footer>

<script>
function goToStep(n){
  document.querySelectorAll('.step').forEach(s=>s.classList.remove('active'));
  document.getElementById('step'+n).classList.add('active');
  for(let i=1;i<=3;i++){
    document.getElementById('dot'+i).className =
      'h-1.5 flex-1 rounded-full ' + (i<=n?'bg-teal-600':'bg-slate-200');
  }
}

{% if results %}
const places={{ results|tojson }};
const map=L.map('map',{scrollWheelZoom:false,zoomControl:false});
L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
const bounds=[];
places.forEach(p=>{
  L.marker([p.destination_latitude,p.destination_longitude])
    .addTo(map)
    .bindPopup(`<b>${p.destination}</b>`);
  bounds.push([p.destination_latitude,p.destination_longitude]);
});
map.fitBounds(bounds,{padding:[50,50]});
{% endif %}
</script>

</body>
</html>
